<!DOCTYPE html>
<html>

<!-- Example Sidebar used here -->
<!-- https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_collapse_sidebar -->

<!-- Example Navbar used here -->
<!-- https://getbootstrap.com/docs/4.0/components/navbar/ -->

<!-- Deck GL examples -->
<!-- https://observablehq.com/@pessimistress -->

<!-- DECK GL HTML EXAMPLE -->
<!-- https://deck.gl/gallery/arc-layer -->

<!-- MAPBOX ACCESS TOKEN -->
<!--
pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA
-->

<!-- LEAFLET GL -->
<!-- http://bl.ocks.org/reyemtm/c93cdc699b06b0b5305a9312efa2282d -->

  <head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel='stylesheet' />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css' rel='stylesheet' />

    <link href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>  
    <!-- <link href="hamburgers.css" rel="stylesheet"> -->
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js'></script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.vectorgrid@latest/dist/Leaflet.VectorGrid.bundled.js"></script>
     
     <script src="//unpkg.com/vis-charts@latest/dist/vis.min.js"></script>
    <link href="//unpkg.com/vis-charts@latest/dist/vis.min.css" rel="stylesheet" type="text/css">
    <!--
    div-charts (i.e., above vis.min.js) should be removed in favor of the below vis-networ and vis-timeline
     but as of now, vis-network and vis-timeline are not working well together. vis-timeline includes graph2d, 
     which we want to use for the logic models.
     See: https://stackoverflow.com/questions/58092020/combine-vis-network-and-vis-timeline-on-same-page and
          https://github.com/visjs/vis-network/pull/85
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    
    
    <script type="text/javascript" src="https://unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <link href="//unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" /> -->
    
    <link rel="stylesheet" href="//unpkg.com/leaflet-gesture-handling/dist/leaflet-gesture-handling.min.css" type="text/css">
    <script src="//unpkg.com/leaflet-gesture-handling"></script>    
    <!-- MBTiles for leaflet. Downloaded from https://gitlab.com/IvanSanchez/Leaflet.TileLayer.MBTiles -->
    <script src="https://unpkg.com/sql.js@0.3.2/js/sql.js"></script>
    
    <!--
    <script src = "TileLayer.Grayscale.js"></script>
    -->
    
    <style>
    
      body {
        font-family: "Roboto", sans-serif;
        background-color: #111;
        margin: 0;
        height: 100%;
        color: #818181;
        font-size:15px;
        line-height: 1.4;
        overscroll-behavior: contain;
      }
      
      /* Right-side navigation */
      /* https://www.w3schools.com/howto/howto_css_fixed_sidebar.asp */
      .sidenav {
        width: 60px;
        position: fixed;
        z-index: 1;
        right: 10px;
        top: 70px;
        background-color: #111;
        opacity: 0.7;
        overflow-x: hidden;
        padding: 8px 10px;
        border-radius: 4px;
      }
      .sidebar {
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 55px;
        left: 0;
        background-color: #111;
        opacity: 0.8;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 15px;
      }
      
      .sidebar a {
        padding: -1px 2px 2px 2px;
        text-decoration: none;
        font-size: 25px;
        color: #818181;
        display: block;
        transition: 0.3s;
      }
      
      .sidebar a:hover, button:hover {
        color: #f1f1f1;
      }


     /*!
       * Hamburgers
       * @description Tasty CSS-animated hamburgers
       * @author Jonathan Suh @jonsuh
       * @site https://jonsuh.com/hamburgers
       * @link https://github.com/jonsuh/hamburgers
       */
      .hamburger {
        padding: 15px 5px 10px 15px;
        display: inline-block;
        cursor: pointer;
        transition-property: opacity, filter;
        transition-duration: 0.15s;
        transition-timing-function: linear;
        font: inherit;
        color: #818181;
        text-transform: none;
        background-color: #111;
        border: 0;
        margin: 0;
        overflow: visible; }
        .hamburger:hover .hamburger-inner {
          background-color: #f1f1f1;
        }
        .hamburger:hover .hamburger-inner::before {
          background-color: #f1f1f1;
        }
        .hamburger:hover .hamburger-inner::after {
          background-color: #f1f1f1;
        }
        .hamburger.is-active:hover .hamburger-inner {
          background-color: #f1f1f1;
        }
        .hamburger.is-active:hover .hamburger-inner::before {
          background-color: #f1f1f1;
        }
        .hamburger.is-active:hover .hamburger-inner::after {
          background-color: #f1f1f1;
        }        
        .hamburger.is-active .hamburger-inner,
        .hamburger.is-active .hamburger-inner::before,
        .hamburger.is-active .hamburger-inner::after {
          color: #f1f1f1; }
      
      .hamburger-box {
        width: 40px;
        height: 24px;
        display: inline-block;
        position: relative; 
        padding:0;
      }
      
      .hamburger-inner {
        display: block;
        top: 50%;
        margin-top: -2px; }
        
        /* change this width to change the width of the hamburger  */
        .hamburger-inner, .hamburger-inner::before, .hamburger-inner::after {
          width: 30px; 
          height: 3px;
          background-color: #818181;
          border-radius: 4px;
          position: absolute;
          transition-property: transform;
          transition-duration: 0.15s;
          transition-timing-function: ease; }
        .hamburger-inner::before, .hamburger-inner::after {
          content: "";
          display: block; }
        .hamburger-inner::before {
          top: -10px; }
        .hamburger-inner::after {
          bottom: -10px; }
        .hamburger-inner:hover{
          color: #f1f1f1;
        }

    
      .hamburger--slider .hamburger-inner {
        top: 2px; }
        .hamburger--slider .hamburger-inner::before {
          top: 10px;
          transition-property: transform, opacity;
          transition-timing-function: ease;
          transition-duration: 0.15s; }
        .hamburger--slider .hamburger-inner::after {
          top: 20px; }
      
      .hamburger--slider.is-active .hamburger-inner {
        transform: translate3d(0, 10px, 0) rotate(45deg); }
        .hamburger--slider.is-active .hamburger-inner::before {
          transform: rotate(-45deg) translate3d(-5.71429px, -6px, 0);
          opacity: 0; }
        .hamburger--slider.is-active .hamburger-inner::after {
          transform: translate3d(0, -20px, 0) rotate(-90deg); }

      .hamburger:active, .hamburger:focus {
        outline: 0;
        border: none;
        -moz-outline-style: none;
      }

      /* https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_accordion_animate */
      .accordion {
        background-color: #111; /* Change this to add color to the background of a dropdown menu title */
        color: #818181;
        width: 100%;
        padding: 2px 2px 2px 10px;
        font-size: 20px;
        cursor: pointer;
        border: none;
        display: block;
        outline: none;
        text-align: left;
        transition: 0.4s;
      }
      
      .panel {
        padding: 0 18px;
        display: none;
        background-color: #111;
        overflow: hidden;
      }

      .navbar {
        -webkit-box-shadow: 0px -10px 40px 26px rgba(22,22,23,1);
        -moz-box-shadow: 0px -10px 40px 26px rgba(22,22,23,1);
        box-shadow: 0px -10px 40px 26px rgba(22,22,23,1);
        margin-top: 0px;
        padding: 0px;
      }
      
      .mapboxgl-map {
        -webkit-box-shadow: 0px -10px 40px 26px rgba(22,22,23,1);
        -moz-box-shadow: 0px -10px 40px 26px rgba(22,22,23,1);
        box-shadow: 0px -10px 40px 26px rgba(22,22,23,1); 
      }
      
      #main {
        transition: margin-left .5s;
        padding: 16px;
      }
      
      .deck-tooltip {
        font-family: Helvetica, Arial, sans-serif;
        padding: 6px !important;
        margin: 8px;
        max-width: 300px;
        font-size: 10px;
      }
      
      /* HOVER TOOLTIP on LMU LAYER */
      .toolTip_class{
        background-color: #111;
        color: #818181;
      }
      
      #tooltipTable{
        border-collapse: collapse;
        border: 0px solid white;
        font-size: 15px;
        direction: left;
      }
      
      /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a              smaller font size) */
      @media screen and (max-height: 450px) {
        .sidebar {padding-top: 15px;}
        .sidebar a {font-size: 18px;}
      }
      

      
      .slider {
        -webkit-appearance: none;
        width: 100%;
        height: 15px;
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
      }
      
      div:active, div:focus {
        outline: 0;
        -moz-outline-style: none;
      }      
      
      .slider:hover {
        opacity: 1;
      }
      
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 15px;
        height: 15px;
        background: #315b7d;
        cursor: pointer;
      }
      
      .slider::-moz-range-thumb {
        width: 15px;
        height: 15px;
        background: #315b7d;
        cursor: pointer;
      }
      
      .legend {
        z-index: 800;
        line-height: 18px;
        color: #818181;
      }
      .legend i {
        z-index: 800;
        width: 18px;
        height: 18px;
        float: left;
        margin-right: 8px;
        opacity: 0.7;
      }
      
      .info {
        padding-right: 20px;
        padding-bottom: 10px;
        font: 12px;
      }
      div.info.legend.leaflet-control br {
        z-index: 800;
        clear: both;
      }
      
      
      
      html {
        width: 100%;
        height: 100%;
        margin-top: 25px;
        position: absolute;
        scroll-behavior: smooth;
      }
      
      
      #wrapper{
        position:absolute;
        height:100%;
        width:100%;
      }
      
      .panels { 
        position:relative;
        height:100%;
        min-height:100%;
        width:100%;
        z-index:1000;
    }
    
      #map{
        position:fixed;
        color:red;
        top:0;
        z-index:300;
        margin-top: 50px;
      }

      
      
      #info_panel{
         bottom: -10%;
         scroll-margin-top: 200px;
         width: 98%;
         opacity:0.8;
         margin-left:1%;
         padding: 8px;
         border-radius: 8px;
      }
      
      #info_panel2{
         scroll-margin-top: 100px;
         width:98%;
         margin-left:1%;         
      }      

    /* TOC on right with links to different sections 
      #infoi {
        position: relative;

      }
    */
    
      /* width */
      ::-webkit-scrollbar {
        width: 10px;
        border-radius: 12px;
      }
      
      /* Track */
      ::-webkit-scrollbar-track {
        background: #f1f1f1; 
      }
       
      /* Handle */
      ::-webkit-scrollbar-thumb {
        background: #888; 
      }
      
      /* Handle on hover */
      ::-webkit-scrollbar-thumb:hover {
        background: #555; 
      } 
      
      .leaflet-control{
        z-index: 2000;
      }
      
      /* These leaflet-bar things adjust the style of the zoom controls */
      .leaflet-bar{
        width:50px;
        float:center;
      }
      .leaflet-bar a, .leaflet-control-layers-toggle {
        width: 75%;
        background-color:#111;
        color:white;
        float: center;
      }
      .leaflet-bar a, .leaflet-bar a:hover{
        width:75%;
        border-bottom:0;
      }
      .leaflet-bar a.leaflet-disabled{
        background-color:#111;
        color:white;
      }
      
      
      .leaflet-bottom.leaflet-right .leaflet-control {
            margin-bottom: 6vh;
            background-color: #111;
            opacity: 0.7;
            padding: 10px;
            border-radius: 4px;
      }      
      
      /* Arrows for the bottom-hidden info pane div */
      .arrow_nav{
        float:right;
      }
      
      .arrow{
        border: solid black;
        border-width: 0 3px 3px 0;
        display: inline-block;
        padding: 3px;
      }
      
      .arrow_down {
        position: relative;
        top: -5px;
        content: "";
        display: inline-block;
        width: 15px;
        height: 15px;
        border-right: 0.2em solid #818181;
        border-top: 0.2em solid #818181;
        transform: rotate(135deg);
        margin-right: 0.5em;
        margin-left: 1.0em;

      }
      
      .arrow_up {
        position: relative;
        top: -5px;
        content: "";
        display: inline-block;
        width: 15px;
        height: 15px;
        border-right: 0.2em solid #818181;
        border-top: 0.2em solid #818181;
        transform: rotate(-45deg);
        margin-right: 0.5em;
        margin-left: 1.0em;
       } 

      
      #mynetwork {
        margin: 0px;
        padding: 0px; 
        
        position: absolute;
        display: inline-block;
        top: 5vh;
        left: 0px;
        bottom: 0px;
        right: 0%;
        
        background: transparent;
      }
      
      
      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 5000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
      }
      
      /* Modal Content/Box */
      .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
      }
      
      /* The Close Button */
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }
      
      .close:hover,
      .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
      }      

      body.modal-open div.modal-backdrop { 
          z-index: 0 !important; 
      }      
    </style>
    
  </head>





  <body>
  
    <nav class="navbar fixed-top navbar-dark" style="background-color: #111;">
      
      <div class="sidenav" >
        
            <table>
            <tr>
              <td id = "right_sidebar">
              </td>
            </tr>
            </table>
            
            <hr color = "white" style = "border-top: 2px solid white; padding:0;">
            
            <table>
            <tr >
              <td >

                <a href="#top" style = "color:white">Map</a>
              </td>
            </tr>
            
            <tr>
              <td>
                <a href="#info_panel" style = "color:white">Stats</a>
              </td>
            </tr>
            
            <tr>
              <td>
                <a href="#info_panel2" style = "color:white">Other</a>
              </td>
            </tr>
            
            </table>        

      </div>      
      
      <!-- 
      <button class="openbtn" id = "openButton">&#9776;</button> 
      -->
      
      <!-- https://github.com/jonsuh/hamburgers  -->
      <button class="hamburger hamburger--slider" id = "openButton" type="button">
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </button>      
    
      <div id="mySidebar" class="sidebar">
        <!-- 
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">x</a>
        <a id = "href_about" href="#">About</a> 
        -->
        <button class="accordion">Basemap</button>
        <div class = 'panel'>
          <a id = 'basemap_dark' href = "#" style = "font-size:20px; padding:0;">Relief</a>
          <a id = 'basemap_satellite' href = "#" style = "font-size:20px; padding:0;">Satellite</a>
        </div>

        <button class="accordion">Boundaries</button>
        <div class = "panel">
          
          <table>
            <tr>
              <td style = "width:70%">
               <a id = 'layer_tcsiBounds' href = "#" style = "font-size:20px; padding:0;">TCSI boundary</a>
              </td>
              <td style = "width:30%;vertical-align:center; padding-top:8px;">
                <input type="range" min="0" max="3" value="1" class="slider" id="slider_tcsi_boundary" onchange = "tcsi_boundary_slider_func(this.value)">
              </td>
            </tr>
            <tr>
              <td style = "width:70%">
                <a id = 'layer_lmu' href = "#" style = "font-size:20px; padding:0;">LMU</a>
              </td>
              <td style = "width:30%; vertical-align:center; padding-top:8px;">
                <input type="range" min="1" max="100" value="50" class="slider" id="slider_lmu" onchange= "lmu_slider_func(this.value)">
              </td>
            </tr>

          </table>

        </div>

        <button class = "accordion">Disturbance</button>
        
        <div class = "panel">
          
          <table>
            
            <tr>
              <td style = "width:70%">
               <a id = 'layer_drid' href = "#" style = "font-size:20px; padding:0;">pDRID</a>
              </td>
              <td style = "width:30%;vertical-align:center; padding-top:8px;">
                <input type="range" min="1" max="100" value="50" class="slider" id="slider_drid" onchange = "drid_slider_func(this.value)">
              </td>
            </tr>
            
            <tr>
              <td style = "width:70%">
               <a id = 'layer_tsld' href = "#" style = "font-size:20px; padding:0;">Years since last disturbance</a>
              </td>
              <td style = "width:30%;vertical-align:center; padding-top:8px;">
                <input type="range" min="1" max="100" value="50" class="slider" id="slider_tsld" onchange = "tsld_slider_func(this.value)">
              </td>
            </tr>
            
            <tr>
              <td style = "width:70%">
               <a id = 'layer_n_dist' href = "#" style = "font-size:20px; padding:0;">Number of disturbances</a>
              </td>
              <td style = "width:30%;vertical-align:center; padding-top:8px;">
                <input type="range" min="1" max="100" value="50" class="slider" id="slider_ndist" onchange = "ndist_slider_func(this.value)">
              </td>
            </tr>            
            
          </table>
          
        </div>

      </div>
      
    </nav>
    
    
    
    <script>
    
    // Change hamburger button class on click from open hamburger to close X
    $(document).ready(function(){
      
      $('#openButton').click(function(){
        $(this).children('span').toggleClass('hamburger hamburger--slider" "hamburger hamburger--slider is-active');
      })
      
    })
    
    </script>
    
    
    
    <script>
    
    // Put zoom and TOC in small right hand sidebar
    //https://stackoverflow.com/questions/41475855/adding-leaflet-layer-control-to-sidebar
      $(document).ready(function(){
        
        if(L.Browser.mobile){

          $("#info_panel").css({
             "margin-top" : "82vh"
          });
        }
        else{

          $("#info_panel").css({
             "margin-top" : "82vh"
          });
          
        }
        
      })

    /*
    var windowHt = window.innerHeight;
    var scrollHt = 135;
    var scrollDir;
    var scroll_01 = $(document).scrollTop();

      $(document).scroll(function() {
        
        var currSH = $(this).scrollTop();
        var currSHp = 1 - $(this).scrollTop()/windowHt;
        
        if(currSH > scroll_01){
          
          scrollDir = 1;
          console.log(currSHp);
          
          if(currSH > 700)
            scrollHt += -5;
            
          scrollHt = Math.max(scrollHt, 0);

          $("#infoi").css({
            "top": scrollHt
          });    
        
        }
        else{
          
          scrollDir = -1;
          scrollHt += 6;
          
          scrollHt = Math.min(Math.max(scrollHt, 0), 135);

          $("#infoi").css({
            "top": scrollHt
          });   
        
        }
        
        scroll_01 = $(this).scrollTop();
        
      }); 
      */
      
    </script>
    

    
    <div id = "wrapper">
      
      <div id = "map" class = "panels"></div>
      
            <!-- The Modal -->
            <div id="myModal" class="modal">
            
              <!-- Modal content -->
              <div class="modal-content">
                <span class="close">&times;</span>
                <div id = "logic_graph_container"></div>
              </div>
            
            </div>
            
      <div id = "info_panel" class = "panels" style = "background-color:#111">
        

          
          <a id = "this_up_down" class = "up_down_arrow" style = "float:right; cursor:pointer;">
            <span class = "arrow_up" style = "margin-top: 15px; margin-right: 70px;"></span>
          </a>
          
  
        
        <ul class="nav nav-tabs">
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " data-toggle="tab" href="#profile">Data</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Logic model</a>
            <div class="dropdown-menu" style="">
              <a class="dropdown-item" data-toggle="tab" href="#dropdown1">Resilience</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown2">Biodiveristy</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown3" id = "fire_button">Fire dynamics</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown2">Wetland integrity</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown1">Water reliability</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown2">Carbon seq.</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown1">Air quality</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown2">Fire adapted comm.</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown1">Econ diversity</a>
              <a class="dropdown-item" data-toggle="tab" href="#dropdown2">Social wellbeing</a>
              
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#">Main pillars</a>
            </div>
          </li>
          
          <li class="nav-item">
            <a class="nav-link " data-toggle="tab" href="#home">Decision model</a>
          </li>          
          
        </ul>
      
        <div id="myTabContent" class="tab-content">
          
          <div class="tab-pane fade active show" id="home">
            <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby sweater eu banh mi, qui irure terry richardson ex squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis cardigan american apparel, butcher voluptate nisi qui.</p>
          </div>
          
          <div class="tab-pane fade " id="profile">
            <p>Food truck fixie locavore, accusamus mcsweeney's marfa nulla single-origin coffee squid. Exercitation +1 labore velit, blog sartorial PBR leggings next level wes anderson artisan four loko farm-to-table craft beer twee. Qui photo booth letterpress, commodo enim craft beer mlkshk aliquip jean shorts ullamco ad vinyl cillum PBR. Homo nostrud organic, assumenda labore aesthetic magna delectus mollit.</p>
          </div>
          
          <div class="tab-pane fade" id="dropdown1">
            <p>Etsy mixtape wayfarers, ethical wes anderson tofu before they sold out mcsweeney's organic lomo retro fanny pack lo-fi farm-to-table readymade. Messenger bag gentrify pitchfork tattooed craft beer, iphone skateboard locavore carles etsy salvia banksy hoodie helvetica. DIY synth PBR banksy irony. Leggings gentrify squid 8-bit cred pitchfork.</p>
          </div>
          
          <div class="tab-pane fade" id="dropdown2">
            <p>Trust fund seitan letterpress, keytar raw denim keffiyeh etsy art party before they sold out master cleanse gluten-free squid scenester freegan cosby sweater. Fanny pack portland seitan DIY, art party locavore wolf cliche high life echo park Austin. Cred vinyl keffiyeh DIY salvia PBR, banh mi before they sold out farm-to-table VHS viral locavore cosby sweater.</p>
          </div>
          
          <div class="tab-pane fade" id = "dropdown3">
            
            <div id = "mynetwork"></div>


            
          </div>          
        
        </div> 
         
      </div>
    
    </div>



    <script>
    // Other example: https://jsbin.com/kurukuxeza/edit?html,output
    
      // create an array with nodes
      var nodes = new vis.DataSet([
        { id: 1, label: "Node 1" },
        { id: 2, label: "Node 2" },
        { id: 3, label: "Node 3" },
        { id: 4, label: "Node 4" },
        { id: 5, label: "Node 5" }
      ]);

      // create an array with edges
      var edges = new vis.DataSet([
        { from: 1, to: 3 },
        { from: 1, to: 2 },
        { from: 2, to: 4 },
        { from: 2, to: 5 },
        { from: 3, to: 3 }
      ]);

      // create a network
      var container_network = document.getElementById("mynetwork");
      

      var data_network = {
        nodes: nodes,
        edges: edges
      };

      
      var options_network = {
            locale: 'en',        
            height: '100%',
            width: '100%',
            physics: {
                 "enabled": true
             },
            nodes: {
              fixed: false
            },
            interaction: {
                dragNodes: true,
                dragView:false
            },            
            layout: {randomSeed: 0}
      };
      


  
      var network = new vis.Network(container_network, data_network, options_network);



      // For some reason it is placing the network in the upperleft corner, this moves it once the mouse is over...
      //  pretty rediculous...
      
      $("#fire_button").on('click', function(){
        network.moveTo({
            position: {x:10, y:10},
            scale: 1
        }); 
      }) 

      $("#mynetwork").on('mouseover', function(){
        network.moveTo({
            position: {x:20, y:20},
            scale: 1
        });  
      }) 

      /*
      THis worked too, but for some reason I couldn't zoom in or out afterwards...
      network.on("afterDrawing", function (ctx) {
        network.moveTo({
            position: {x:20, y:20},
            scale: 1
        });        
      });
      */
      
      // OPEN MODAL DIALOGUE BOX
      network.on( 'click', function(properties) {
          var ids = properties.nodes;
          var clickedNodes = nodes.get(ids);
          clickedNodes_id = clickedNodes[0].id
          console.log('clicked nodes:', clickedNodes_id);
          

          if(!clickedNodes[0].id !== 'undefined'){
          
            // Get the modal
            var modal = document.getElementById("myModal");

            // This is from the vis.js library, it is very timeline focused
            // I think we may want to use d3: https://www.d3-graph-gallery.com/connectedscatter.html
            var container_graph = document.getElementById('logic_graph_container');
            
              var items = [
                {x: 0, y: -1},
                {x: 250, y: 1},
                {x: 500, y: 1},
                {x: 1000, y: -1},
                {x: 2000, y: -1}
              ]; 

              var dataset_graph = new vis.DataSet(items);
              
              var options_graph = {
                start: 0,
                end: 2000,
                lineTension: 0
              };
              
          
              var graph2d = new vis.Graph2d(container_graph, dataset_graph, options_graph);
              
            //$('#myModal').modal('show'); 
            //$(".modal-content").children("div").text("Clicked on node: " + clickedNodes_id);            
            
            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];
            
            // When the user clicks the button, open the modal 
  
              modal.style.display = "block";
            
            
            // When the user clicks on <span> (x), close the modal
            span.onclick = function() {
              modal.style.display = "none";
              graph2d.destroy();
            }
            
            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
              if (event.target == modal) {
                modal.style.display = "none";
                graph2d.destroy();
              }
            } 
            
          }

         

      });
      


    </script>





    <!-- THIS CHANGES THE UP ARROW on the in info panel to a down arrow and changes the href -->
    <script>  

      $('#this_up_down').click(function(){

        //$(this).attr('href', $(this).children('span').attr( "class" ) == "arrow_up" ? '#info_panel' : '#map');
        //alert($(this).attr('href'));
        $(this).children('span').toggleClass('arrow_up arrow_down');

        if($(this).children('span').hasClass("arrow_up")){
          
          $('body, html').animate({
                  scrollTop: 0
              }, 10);          
        }
        else{
          $('body, html').animate({
                  scrollTop: $("#info_panel").offset().top - 100
              }, 10);           
        }

      });
      
      $('#this_up_down').mouseenter(function(){
        $(this).children('span').css("border-right", "0.2em solid #f1f1f1").css("border-top", "0.2em solid #f1f1f1");
      });
      $('#this_up_down').mouseleave(function(){
        $(this).children('span').css("border-right", "0.2em solid #818181").css("border-top", "0.2em solid #818181");
      });      
      
    </script>


  
  <!-- 
  RASTER TILES:
  Used tiler package in R to convert from raster to raster tile. This included a color ramp and allowed NA to be
   transparent, so it worked great. Then I uploaded them to github. The trick there was the http address needed
   for the L.tileLayer to find it ("https://github.com/tsuga11/tcsi_blueprint/raw/master/raster_tiles/tsld_1970_2019/{z}/{x}/{-y}.png"). Notice the -y not y at the end, and the "raw/master/" in the address. I settled on zoom levels
   9 - 16, which takes about an hour to run for one raster and results in 10,000s of small files. Any higher zoom
   level and it took forwever to run. 9 - 15 took 15 minutes for instance.
   
   VECTOR TILES:
   Uploaded shapefile to mapbox and used L.vectorGrid.protobuf.
  
  -->
  
  
 

  
  <!-- ALL THE MAPPING AND TILES STUFF -->
    <script>
    

      map = L.map('map', {
        minZoom: 9,
        maxZoom: 21,
        zoomControl: false,
        gestureHandling: true
      }).setView([39.1, -120.4], 9); // Create map object and pass it our options object from above
      
      
      map.on('zoomend',function(e){
        console.log(map.getZoom())
      });      
      
      // Put zoom and TOC in small right hand sidebar
      //https://stackoverflow.com/questions/41475855/adding-leaflet-layer-control-to-sidebar
      var zoomCtrl = L.control.zoom({ position:'topright' }).addTo(map);

      var zoomCtrl_htmlObject = zoomCtrl.getContainer();
      var a_right_sidebar = document.getElementById('right_sidebar')
        function setParent(el, newParent){
          newParent.appendChild(el);
        }
        setParent(zoomCtrl_htmlObject, a_right_sidebar);



    //var toc = L.control({position: 'topright'})
    //toc.onAdd = function(map){
    //      var div = L.DomUtil.create('div');
    //      div.innerHTML = `
    //      <table>
          
    //      <tr>
    //      <td>
    //      <a href="#map" style = "color:white">Map</a>
    //      </td>
    //      </tr>
          
    //      <tr>
    //      <td>
    //      <a href="#info_panel" style = "color:white">Stats</a>
    //      </td>
    //      </tr>
          
    //      </table>`; 
    //      return div;
    //}
      
    //toc.addTo(map);
      
      ///
      /// LAYERS Open up
      ///

      // Some example styling
      // https://openmaptiles.org/docs/website/leaflet/ 

      // See about feature selection
      // https://www.ovrdc.org/apps/vector-grid-pbf.html#15/38.7509/-82.8590
      
      // Also see L.Browser.mobile to determine if mobile or not
      
      // TCSI Boundary
      var tcsi_boundary_layer = L.vectorGrid.protobuf(
        "https://api.mapbox.com/v4/tsuga11.48jp66kf/{z}/{x}/{y}.vector.pbf?access_token={token}", {
          
          rendererFactory: L.svg.tile, // L.canvas.tile

          vectorTileLayerStyles: {
            
            "TCSI_boundary-9wfci2": function(properties, zoom){
              return{
                 weight: 1.0,
                 color: '#FFFFFF',
                 fill: false,
                 opacity: 0.5
              }              
            }
            
          },

          token: "pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA"
      });   
      
      
      

      // LMU x CC layer
      var lmu_layer = L.vectorGrid.protobuf(
        "https://api.mapbox.com/v4/tsuga11.ainhfbxb/{z}/{x}/{y}.vector.pbf?access_token={token}", {
          
          rendererFactory: L.svg.tile,
          
          interactive: true,
          getFeatureId: function(f) {
           return f.properties.ID;
          },
                 
          vectorTileLayerStyles: {
            
            "TCSI_LMU_simp-dawgta": function(properties, zoom){ //TCSI_LMU-5hxymj
              var level = properties.LMU;
              if(level == 1){col = "#ffffcc";}
              else if(level == 2){col = "#238443";}
              else if(level == 3){col = "#78c679";}
              else if(level == 4){col = "#c2e699";}
              
              return{
                 weight: 0.1,
                 color: '#FFFFFF',
                 fillColor: col,
                 fill: true,
                 opacity: 0.5,
                 fillOpacity: 0.5
              }              
            }
            
          },
          //subdomains: "abcd",
          token: "pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA"
      }).on('mouseover', function(e) {	// The .on method attaches an event handler
      
				clearHighlight();
				
				highlight = e.layer.properties.ID;
				//alert(highlight);
				lmu_layer.setFeatureStyle(highlight, { // HOVER HIGHLIGHT on LMU LAYER
					weight: 1,
					color: '#8b7500',
					opacity: 0.5,
					fill: true,
					fillOpacity: 0.5
				})

				L.DomEvent.stop(e);
			}).on('click', function(e){ // CLICK EVENT on LMU LAYER
			  var_01 = e.layer.properties.ID;

			  //alert(var_01);
			 
			  return{
			    var_01
			  }
			}).bindTooltip(function (layer) { // HOVER TOOLTIP on LMU LAYER
			  
			  //var_01 = layer.properties.LMU;
			  if(layer.properties.LMU == 1){var_01 = '1: Ridge';}
			  else if(layer.properties.LMU == 2){var_01 = '2: Valley';}
			  else if(layer.properties.LMU == 3){var_01 = '3: NE slope';}
			  else{var_01 = '4: SW slope';}
        
        //return String(var_01);
        return String("<table id = 'tooltipTable'>" +
                       "<tr> <td><b>ID: </b></td> <td><b>" + layer.properties.ID  + " </b></td> </tr>" + 
                       "<tr> <td>LMU: </td> <td>" + var_01  + " </td> </tr>" +
                       "<tr> <td>Clim class: </td> <td>" + layer.properties.climClass  + " </td> </tr>" +
                       "<tr> <td>Hectares: </td> <td>" + layer.properties.Hectares  + " </td> </tr>" + 
                       "</table>");
        
        }, 
        {sticky: true, 
         opacity: 0.7, 
         direction: 'right',
         className: 'toolTip_class'
        });

      
      
      
      // DRID layer
      var drid_layer = L.vectorGrid.protobuf(
        "https://api.mapbox.com/v4/tsuga11.7dlh8jo8/{z}/{x}/{y}.vector.pbf?access_token={token}", {
          
          rendererFactory: L.svg.tile,
          
          interactive: true,
          getFeatureId: function(f) {
           return f.properties.Id;
          },
                 
          vectorTileLayerStyles: {
            
            "drid_1970_2019_tcsi-7f7r5z": function(properties, zoom){ //TCSI_LMU-5hxymj
              var level = properties.pDRID;
              if(level == 1){col = "#1a7994";}
              else if(level == 2){col = "#00abee";}
              else if(level == 3){col = "#74defc";}
              else if(level == 4){col = "#ffffeb";}
              else if(level == 5){col = "#feaa1b";}
              else {col = "#c7110c";}
              
              return{
                 weight: 0.1,
                 color: '#FFFFFF',
                 fillColor: col,
                 fill: true,
                 opacity: 0.5,
                 fillOpacity: 0.5
              }              
            }
            
          },
          //subdomains: "abcd",
          token: "pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA"
      }).on('mouseover', function(e) {	// The .on method attaches an event handler
      
				clearHighlight();
				
				highlight = e.layer.properties.Id;
				//alert(highlight);
				drid_layer.setFeatureStyle(highlight, { // HOVER HIGHLIGHT on LMU LAYER
					weight: 1,
					color: '#8b7500',
					opacity: 0.5,
					fill: true,
					fillOpacity: 0.5
				})

				L.DomEvent.stop(e);
			}).bindTooltip(function (layer) { 
			  var pDrid_var;
			  
			  if(layer.properties.pDRID == 1){pDrid_var = '<-66%';}
			  else if(layer.properties.pDRID == 2){pDrid_var = '-66 to -33%';}
			  else if(layer.properties.pDRID == 3){pDrid_var = '-33 to 0%';}
			  else if(layer.properties.pDRID == 4){pDrid_var = '0 to 33%';}
			  else if(layer.properties.pDRID == 5){pDrid_var = '33 to 66%';}
			  else{pDrid_var = '>66%';}
        
        //return String(pDrid_var);
        return String("<table id = 'tooltipTable'>" +
                       "<tr> <td><b>ID: </b></td> <td><b>" + layer.properties.Id  + " </b></td> </tr>" + 
                       "<tr> <td>pDRID: </td> <td>" + pDrid_var  + " </td> </tr>" +
                       "<tr> <td>Time since dist.: </td> <td>" + layer.properties.tsld  + " </td> </tr>" +
                       "<tr> <td>Num. dist.: </td> <td>" + layer.properties.n_dist  + " </td> </tr>" + 
                       "</table>");
        
        }, 
        {sticky: true, 
         opacity: 0.7, 
         direction: 'right',
         className: 'toolTip_class'
        });
      
      


      // TSLD layer
      var tsld_layer = L.vectorGrid.protobuf(
        "https://api.mapbox.com/v4/tsuga11.7dlh8jo8/{z}/{x}/{y}.vector.pbf?access_token={token}", {
          
          rendererFactory: L.svg.tile,
          
          interactive: true,
          getFeatureId: function(f) {
           return f.properties.Id;
          },
                 
          vectorTileLayerStyles: {
            
            "drid_1970_2019_tcsi-7f7r5z": function(properties, zoom){ 
              var level = properties.tsld;

              if(level >= 1 && level < 10){col = "#ffffd4";}
              else if(level >= 10 && level < 20){col = "#fee391";}
              else if(level >= 20 && level < 30){col = "#fec44f";}
              else if(level >= 30 && level < 40){col = "#fe9929";}
              else if(level >= 40 && level < 50){col = "#d95f0e";}
              else {col = "#993404";}
              
              return{
                 weight: 0.1,
                 color: '#FFFFFF',
                 fillColor: col,
                 fill: true,
                 opacity: 0.5,
                 fillOpacity: 0.5
              }            
            }
          },
          //subdomains: "abcd",
          token: "pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA"
      }).on('mouseover', function(e) {	// The .on method attaches an event handler
      
				clearHighlight();
				
				highlight = e.layer.properties.Id;
				
				//alert(highlight);
				tsld_layer.setFeatureStyle(highlight, { 
					weight: 1,
					color: '#8b7500',
					opacity: 0.5,
					fill: true,
					fillOpacity: 0.5
				})

				L.DomEvent.stop(e);
			}).bindTooltip(function (layer) { 
			  var pDrid_var;

			  if(layer.properties.pDRID == 1){pDrid_var = '<-66%';}
			  else if(layer.properties.pDRID == 2){pDrid_var = '-66 to -33%';}
			  else if(layer.properties.pDRID == 3){pDrid_var = '-33 to 0%';}
			  else if(layer.properties.pDRID == 4){pDrid_var = '0 to 33%';}
			  else if(layer.properties.pDRID == 5){pDrid_var = '33 to 66%';}
			  else{pDrid_var = '>66%';}
        
        //return String(pDrid_var);
        return String("<table id = 'tooltipTable'>" +
                       "<tr> <td><b>ID: </b></td> <td><b>" + layer.properties.Id  + " </b></td> </tr>" + 
                       "<tr> <td>pDRID: </td> <td>" + pDrid_var  + " </td> </tr>" +
                       "<tr> <td>Time since dist.: </td> <td>" + layer.properties.tsld  + " </td> </tr>" +
                       "<tr> <td>Num. dist.: </td> <td>" + layer.properties.n_dist  + " </td> </tr>" + 
                       "</table>");
        
        }, 
        {sticky: true, 
         opacity: 0.7, 
         direction: 'right',
         className: 'toolTip_class'
        });
      
      
      
      
      // N disturbances layer
      var n_dist_layer = L.vectorGrid.protobuf(
        "https://api.mapbox.com/v4/tsuga11.7dlh8jo8/{z}/{x}/{y}.vector.pbf?access_token={token}", {
          
          rendererFactory: L.svg.tile,
          
          interactive: true,
          getFeatureId: function(f) {
           return f.properties.Id;
          },
                 
          vectorTileLayerStyles: {
            
            "drid_1970_2019_tcsi-7f7r5z": function(properties, zoom){ 
              var level = properties.n_dist;

              if(level == 1){col = "#ffffcc";}
              else if(level == 2){col = "#ffeda0";}
              else if(level == 3){col = "#fed976";}
              else if(level == 4){col = "#feb24c";}
              else if(level == 5){col = "#fd8d3c";}
              else if(level == 6){col = "#fc4e2a";}
              else if(level == 7){col = "#e31a1c";}
              else if(level == 8){col = "#bd0026";}
              else {col = "#800026";}
              
              return{
                 weight: 0.1,
                 color: '#FFFFFF',
                 fillColor: col,
                 fill: true,
                 opacity: 0.5,
                 fillOpacity: 0.5
              }            
            }
          },
          //subdomains: "abcd",
          token: "pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA"
      }).on('mouseover', function(e) {	// The .on method attaches an event handler
      
				clearHighlight();
				
				highlight = e.layer.properties.Id;
				
				//alert(highlight);
				n_dist_layer.setFeatureStyle(highlight, { 
					weight: 1,
					color: '#8b7500',
					opacity: 0.5,
					fill: true,
					fillOpacity: 0.5
				})

				L.DomEvent.stop(e);
			}).bindTooltip(function (layer) { 
			  var pDrid_var;

			  if(layer.properties.pDRID == 1){pDrid_var = '<-66%';}
			  else if(layer.properties.pDRID == 2){pDrid_var = '-66 to -33%';}
			  else if(layer.properties.pDRID == 3){pDrid_var = '-33 to 0%';}
			  else if(layer.properties.pDRID == 4){pDrid_var = '0 to 33%';}
			  else if(layer.properties.pDRID == 5){pDrid_var = '33 to 66%';}
			  else{pDrid_var = '>66%';}
        
        //return String(pDrid_var);
        return String("<table id = 'tooltipTable'>" +
                       "<tr> <td><b>ID: </b></td> <td><b>" + layer.properties.Id  + " </b></td> </tr>" + 
                       "<tr> <td>pDRID: </td> <td>" + pDrid_var  + " </td> </tr>" +
                       "<tr> <td>Time since dist.: </td> <td>" + layer.properties.tsld  + " </td> </tr>" +
                       "<tr> <td>Num. dist.: </td> <td>" + layer.properties.n_dist  + " </td> </tr>" + 
                       "</table>");
        
        }, 
        {sticky: true, 
         opacity: 0.7, 
         direction: 'right',
         className: 'toolTip_class'
        });
      
      
      // highlight poly on click...
      // https://github.com/Leaflet/Leaflet.VectorGri d/blob/master/docs/demo-points.html
      var highlight;
      var var_01;
  		var clearHighlight = function() {
  			if (highlight) {
  				lmu_layer.resetFeatureStyle(highlight);
  				drid_layer.resetFeatureStyle(highlight);
  				tsld_layer.resetFeatureStyle(highlight);
  				n_dist_layer.resetFeatureStyle(highlight);
  			}
  			highlight = null;
  		};    



     // RASTER LAYERS
     
     // tiler: R package
     // This worked, but couldn't get Leaflet to recognize the file folder heirarchy. Was looking for 
     // folders that didn't exist and filenames that didn't match
     // https://cran.r-project.org/web/packages/tiler/vignettes/tiler-intro.html
     // Tried hostin on github, but that didn't work either for the same reasons
     
     
     // This is the DRID layer in raster form...Used for example now. Couldn't figure out how to sytle the pixels 
     // based on their values.
     // https://rdrr.io/github/gisma/robubu/man/makeTile.html
     

    // var raster_drid = L.tileLayer('https://api.mapbox.com/v4/tsuga11.3qlbb78s/{z}/{x}/{y}.png?access_token={accessToken}', {
       // zIndex: 10,
       // accessToken: 'pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA'
     // });
  
    // THIS WORKS!!! 
    // tiler - R package that converts a tif to raster tiles
    // See TCSI/Scripts/raster_to_tiles.r
    // Might be possible to add a popup of pixel values: https://github.com/mapbox/raster-tile-query
    // For Github, the "raw/master" was not obvious and got it from:
    // https://khufkens.com/2018/09/19/github-tile-server/
     var raster_tsld = L.tileLayer("https://github.com/tsuga11/tcsi_blueprint/raw/master/raster_tiles/tsld_1970_2019/{z}/{x}/{-y}.png", {// ./raster_tiles/tsld_1970_2019/{z}/{x}/{-y}.png
        zIndex: 10,
        tileSize: 256,
        zoomOffset: 0,
        opacity: 0.7,
        maxNativeZoom: 16,
        minNativeZoom: 8
      })
      
          map.on('click', function (e) {
      
	          // the x/y of the tile url
	          var layerPoint = map.project(e.latlng).floor();
	          console.log(layerPoint);
	          var tilePoint = layerPoint.divideBy(256).floor();
	          console.log(tilePoint);
            
        	  var pointInTile = layerPoint.subtract(tilePoint.multiplyBy(256));
        	  console.log(pointInTile);

          });
      

      
     var raster_ndist = L.tileLayer("https://github.com/tsuga11/tcsi_blueprint/raw/master/raster_tiles/n_disturbances_1970_2019/{z}/{x}/{-y}.png", {//L.tileLayer("https://tsuga11.github.io/tcsi/tiles/{z}/{x}/{-y}.png", {
        zIndex: 10,
        tileSize: 256,
        zoomOffset: 0,
        opacity: 0.7,
        maxNativeZoom: 16,
        minNativeZoom: 8
      })    
      
      var raster_drid = L.tileLayer("https://github.com/tsuga11/tcsi_blueprint/raw/master/raster_tiles/drid_1970_2019/{z}/{x}/{-y}.png", {//L.tileLayer("https://tsuga11.github.io/tcsi/tiles/{z}/{x}/{-y}.png", {
        zIndex: 10,
        tileSize: 256,
        zoomOffset: 0,
        opacity: 0.7,
        maxNativeZoom: 16,
        minNativeZoom: 8
      })    

    </script>
    


    <!-- Made MBTILES in QGIS with styling and am showing them with Leaflet using a plugin -->
    <script>
     // THIS ALSO WORKED, BUT THE MBTILES WOULD COVER ONLY PART OF THE STUDY AREA AND MAKE EVERYTHING OUTSIDE OF
     // IT DARK (HTML BACKGROUND), AND THIS ALSO TOOK A LOT LONGER TO CREATE
     // Ended up using QGIS --> Processing --> Toolbox --> Generate XYZ Tiles (MBTiles)
     // DPI 100, extent -123, -118, 37, 41, Min zoom 9, max zoom 15
     // Before conversion, you can color the raster how you like...  
     // Also change the extent using the raster calcultor in QGIS ("drid@1") and change the extent
     
     // var mb = L.tileLayer.mbTiles('./drid.mbtiles',{
     //   zIndex: 25
     // })//.addTo(map);  
    </script>
    

  
  
  
    <!-- 
    ////
    ////
    //// BASEMAPS on/off 
    ////
    ////
    -->
    <script>
      
      // HILLSHADE FROM MAPTILER
      // https://cloud.maptiler.com/tiles/hillshades/leaflet
      var maptiler_hillshade = L.tileLayer('https://api.maptiler.com/tiles/hillshades/{z}/{x}/{y}.png?key=M3abrA0Fni6hIvB5Xsd3',{
        attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank"> MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank"> OpenStreetMap contributors</a>',
        crossOrigin: true,
        maxNativeZoom: 20,
        zIndex:20,
        tileSize: 512,
        zoomOffset: -1        
      }).addTo(map);    
      
   
      // DARK 
      var dark = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/dark-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA', {
        zIndex: 0,
        tileSize: 512,
        zoomOffset: -1
      })

      // HILLSHADE
      var hillshade = L.tileLayer('https://api.mapbox.com/styles/v1/tsuga11/ckcng1sjp2kat1io3rv2croyl/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA', {
        zIndex: 0,
        tileSize: 512,
        zoomOffset: -1
      })
      
      // SATELLITE
      var satellite = L.tileLayer('https://api.mapbox.com/styles/v1/tsuga11/ckcoxq52h0cns1ipevz1tx998/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA', {
        zIndex: 0,
        tileSize: 512,
        zoomOffset: -1
      })      
      
      
      function isOdd(num) { return num % 2;}
      function isEven(num) { return (1 - (num % 2));}

      // Start with adding Dark basemap....
      dark.addTo(map);
      $("#basemap_dark").css({'color' : '#f1f1f1'});


      var basemap_dark_counter = document.getElementById("basemap_dark");
      var basemap_satellite_counter = document.getElementById("basemap_satellite");
      
      basemap_dark_count = 1;
      basemap_satellite_count = 0;
      
      var tcsi_boundary_color = "#FFFFFF"
      
      basemap_dark_counter.onclick = function() {
        basemap_dark_count += 1;
          
          hillshade.remove(map);
          satellite.remove(map);
          dark.addTo(map);
          
          // CHANGE BOUNDARY LAYER FROM WHITE TO BLACK SO IT CAN SHOW UP BETTER ON THE HILLSHADE
          if(isOdd(tcsiBounds_count)){
            
            tcsi_boundary_layer.options.vectorTileLayerStyles["TCSI_boundary-9wfci2"] = () => {
              return{
                   weight: slider_tcsi_boundary.value,
                   color: '#FFFFFF',
                   fill: false,
                   opacity: 0.5
                }   
            }
            
            tcsi_boundary_layer.redraw();
            tcsi_boundary_color = "#FFFFFF"
          }
          
          $("#basemap_dark").css({'color' : '#f1f1f1'});
          $("#basemap_dark").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            }
          )
          $("#basemap_dark").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            }
          ) 

          $("#basemap_satellite").css({'color' : '#818181'});
          $("#basemap_satellite").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#basemap_satellite").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            })
      };
  
  
        basemap_satellite_counter.onclick = function() {
        basemap_satellite_count += 1;
 
          
          dark.remove(map);
          satellite.addTo(map);
          hillshade.remove(map);
          
          // CHANGE BOUNDARY LAYER FROM BLACK TO WHITE SO IT CAN SHOW UP BETTER ON THE HILLSHADE
          if(isOdd(tcsiBounds_count)){

            tcsi_boundary_layer.options.vectorTileLayerStyles["TCSI_boundary-9wfci2"] = () => {
              return{
                   weight: slider_tcsi_boundary.value,
                   color: '#FFFFFF',
                   fill: false,
                   opacity: 0.5
                }   
            }
            
            tcsi_boundary_layer.redraw();
            tcsi_boundary_color = "#FFFFFF"
          }

          
          
          $("#basemap_satellite").css({'color' : '#f1f1f1'});
          $("#basemap_satellite").mouseover(
            function(){
              $(this).css({'color' : '#818181'})
            })
          $("#basemap_satellite").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            })
            
            
          $("#basemap_dark").css({'color' : '#818181'});
          $("#basemap_dark").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#basemap_dark").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            }) 
    
      };
      
    </script>
    
    
    
    
    
    
    
    
    <!-- 
    ///
    ///
    /// ADD LAYERS.... 
    ///
    ///
    -->
    
    <!-- This uses the checkboxes to add/remove TCSI BOUNDARY" -->
    <script>
      
      function isOdd(num) { return num % 2;}
      
      
      // TCSI BOUNDARY on/off...
      var tcsiBounds_counter = document.getElementById("layer_tcsiBounds");
      tcsiBounds_count = 1;
    
      $("#layer_tcsiBounds").css({'color' : '#f1f1f1'});
      $("#layer_tcsiBounds").mouseover(
        function(){
          $(this).css({'color' : '#f1f1f1'})
        }
      )
      $("#layer_tcsiBounds").mouseleave(
        function(){
          $(this).css({'color' : '#f1f1f1'});
        }
      )       
    
      map.options.minZoom = 8;
      map.setZoom(9);
      tcsi_boundary_layer.addTo(map).bringToFront();
    
    
    
      tcsiBounds_counter.onclick = function() {
        tcsiBounds_count += 1;
        
        map.options.minZoom = 9;
        
        if(isOdd(tcsiBounds_count)){

          tcsi_boundary_layer.addTo(map).bringToFront();
          
          $("#layer_tcsiBounds").css({'color' : '#f1f1f1'});
          $("#layer_tcsiBounds").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            }
          )
          $("#layer_tcsiBounds").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            }
          )           
        }
        else{
          
          tcsi_boundary_layer.remove()
          
          $("#layer_tcsiBounds").css({'color' : '#818181'});
          $("#layer_tcsiBounds").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            }
          )
          $("#layer_tcsiBounds").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            }
          )            
        }
      };
  
    </script>     
    
    
    
    <!-- LMU layer -->
    <script>
      
      function isOdd(num) { return num % 2;}
      
      
      // LMU 4 class layer on/off...
      var counter = document.getElementById("layer_lmu");
      count = 0;
    
      counter.onclick = function() {
        count += 1;
        
        map.options.minZoom = 10;
        
        if(map.getZoom() < 10){
          map.setZoom(10);
        }

        
        if(isOdd(count)){
          
          lmu_layer.addTo(map);
          
          $("#layer_lmu").css({'color' : '#f1f1f1'});
          $("#layer_lmu").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            }
          )
          $("#layer_lmu").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            }
          )           
        }
        else{
          
          lmu_layer.remove()
          
          $("#layer_lmu").css({'color' : '#818181'});
          $("#layer_lmu").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            }
          )
          $("#layer_lmu").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            }
          )            
        }
      };
  
    </script>
  
  
  
  
  
  
  
  
     
    <!-- 
    ////
    //// LEGENDS 
    ////
    -->
    <script>
      
      //DRID LEGEND
      var legend_drid = L.control({'position': 'bottomright'});

      function getColor_drid(d) {
          return d == 1  ? '#d53e4f' :
                 d == 2  ? '#fc8d59' :
                 d == 3  ? '#fee08b' :
                 d == 4  ? '#e6f598' :
                 d == 5  ? '#99d594' :
                           '#3288bd' ;
      }      
      
      legend_drid.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
               grades = [1, 2, 3, 4, 5, 6],
               labels = ['<-66%','-66 to -33%','-33 to 0%','0 to 33%','33 to 66%', ">66%"];
               //labels.reverse();
               
          // loop through our density intervals and generate a label with a colored square for each interval
          for (var i = 0; i < grades.length; i++) {
      
              div.innerHTML +=
                  '<i style="background:' + getColor_drid(grades[i]) + '"></i> ' +
                  labels[i] + '<br>';
          }
          return div;
      };
      
      
      //TSLD LEGEND
      var legend_tsld = L.control({'position': 'bottomright'});

      function getColor_tsld(d) {
          return d == 1  ? '#ffffb2' :
                 d == 2  ? '#fed976' :
                 d == 3  ? '#feb24c' :
                 d == 4  ? '#fd8d3c' :
                 d == 5  ? '#f03b20' :
                           '#bd0026' ;
      }      
      
      legend_tsld.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
               grades = [1, 2, 3, 4, 5, 6],
               labels = ['<5', '5-10', '10-20', '20-30', '30-40', '40-50'];
               
      
          // loop through our density intervals and generate a label with a colored square for each interval
          for (var i = 0; i < grades.length; i++) {
      
              div.innerHTML +=
                  '<i style="background:' + getColor_tsld(grades[i]) + '"></i> ' +
                  labels[i] + '<br>';
          }
          return div;
      };   
      
      
      //Numb Dist LEGEND
      var legend_ndist = L.control({'position': 'bottomright'});

      function getColor_ndist(d) {
          return d == 1  ? '#ffffd4' :
                 d == 2  ? '#fee391' :
                 d == 3  ? '#fec44f' :
                 d == 4  ? '#fe9929' :
                 d == 5  ? '#d95f0e' :
                           '#993404' ;
      }      
      
      legend_ndist.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
               grades = [1, 2, 3, 4, 5, 6],
               labels = ['1', '2', '3', '4', '5', '>5'];
               
      
          // loop through our density intervals and generate a label with a colored square for each interval
          for (var i = 0; i < grades.length; i++) {
      
              div.innerHTML +=
                  '<i style="background:' + getColor_ndist(grades[i]) + '"></i> ' +
                  labels[i] + '<br>';
          }
          return div;
      }; 
      
    </script>




    <!-- TURN ON LAYERS -->
    <!-- DRID layer -->
    <script>
      
      function isOdd(num) { return num % 2;}



      // DRID layer on/off...
      var drid_counter = document.getElementById("layer_drid");
      drid_count = 0;
    
      drid_counter.onclick = function() {
        drid_count += 1;
        
        map.options.minZoom = 9;
        
        
        //https://github.com/khufkens/mountain_forest_map
        //var legend_drid = L.control({position: 'bottomright'});

        if(isOdd(drid_count)){
          
          raster_drid.addTo(map);
          legend_drid.addTo(map);

          
          $("#layer_drid").css({'color' : '#f1f1f1'});
          $("#layer_drid").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#layer_drid").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            })
        }
        else{
          raster_drid.remove();
          legend_drid.remove();

         
          $("#layer_drid").css({'color' : '#818181'});
          $("#layer_drid").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#layer_drid").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            })
        }
      };
  
    </script>

     



    <!-- TSLD layer -->
    <script>
      
      // TSLD layer on/off...
      var tsld_counter = document.getElementById("layer_tsld");
      tsld_count = 0;
    
      tsld_counter.onclick = function() {
        tsld_count += 1;
        
        
                  
        map.options.minZoom = 9;

        
        if(isOdd(tsld_count)){

          raster_tsld.addTo(map);    
          legend_tsld.addTo(map);
          
          $("#layer_tsld").css({'color' : '#f1f1f1'});
          $("#layer_tsld").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })

          $("#layer_tsld").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            })   
        }

        else{
          
          raster_tsld.remove()
          legend_tsld.remove();
          
          $("#layer_tsld").css({'color' : '#818181'});
          $("#layer_tsld").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#layer_tsld").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            })
        }
      }




      // N disturbances layer on/off...
      var n_dist_counter = document.getElementById("layer_n_dist");
      n_dist_count = 0;
    
      n_dist_counter.onclick = function() {
        n_dist_count += 1;
        
        map.options.minZoom = 9;

        if(isOdd(n_dist_count)){

          raster_ndist.addTo(map);    
          legend_ndist.addTo(map);
          
          $("#layer_n_dist").css({'color' : '#f1f1f1'});
          $("#layer_n_dist").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })

          $("#layer_n_dist").mouseleave(
            function(){
              $(this).css({'color' : '#f1f1f1'});
            })   
        }

        else{
          
          raster_ndist.remove()
          legend_ndist.remove();
          
          $("#layer_n_dist").css({'color' : '#818181'});
          $("#layer_n_dist").mouseover(
            function(){
              $(this).css({'color' : '#f1f1f1'})
            })
          $("#layer_n_dist").mouseleave(
            function(){
              $(this).css({'color' : '#818181'});
            })
        }
      }
    </script>
     
     
     
     
     
     
    <!-- Update slider for opacity... -->
    <script>
      
        function lmu_slider_func(value){
          
          if(lmu_layer != undefined)
            lmu_layer.setOpacity(value / 100);
            
        }
    
        function tcsi_boundary_slider_func(value){

          // https://github.com/Leaflet/Leaflet.VectorGrid/issues/43
          // Seems ridiculous, but this is how I "setStyle()" in lieu of that working
          tcsi_boundary_layer.options.vectorTileLayerStyles["TCSI_boundary-9wfci2"] = () => {
            return{
                 weight: value,
                 //color: '#FFFFFF',
                 color: tcsi_boundary_color,
                 fill: false,
                 opacity: 0.5
              }   
          }
          


          //alert(tcsi_boundary_layer.options.vectorTileLayerStyles["TCSI_boundary-9wfci2"]);
          
          tcsi_boundary_layer.redraw();              

        }  
        
        
        
        function drid_slider_func(value){
          if(raster_drid != undefined)
            raster_drid.setOpacity(value / 100);
        }
        
        function tsld_slider_func(value){
          if(raster_tsld != undefined)
            raster_tsld.setOpacity(value / 100);
        }  
        
        function ndist_slider_func(value){
          if(raster_ndist != undefined)
            raster_ndist.setOpacity(value / 100);
        }  
        
    </script>   
    
     
     
     
  <script>
    
    document.getElementById("openButton").addEventListener("click", toggleNav);
    
    function toggleNav(){
      navSize = document.getElementById("mySidebar").style.width;

      if (navSize == "300px" || navSize == "200px") {
        return closeNav();
      }
      else{
        return openNav();  
      }
      
    }
    
    
    var sidebar_ct = 0
    
      // Javascript for opening and closing the sidebar...
      function openNav() {
        sidebar_ct += 1
        
        this_var = document.getElementById("mySidebar").style.width
        
        if ($(window).width() < 960) {
          document.getElementById("mySidebar").style.width = "200px";
          document.getElementById("main").style.marginLeft = "200px";
        }
        else {
          document.getElementById("mySidebar").style.width = "300px";
          document.getElementById("main").style.marginLeft = "300px";
        }
      
      }
      
      function closeNav() {
        document.getElementById("mySidebar").style.width = "0";
    //    document.getElementById("main").style.marginLeft= "0";
      }
    
  </script>
  
  
   <!-- THis is the accordion function for the sidebar dropdown menus -->
    <script>
      var acc = document.getElementsByClassName("accordion");
      var i;
      
      for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var panel = this.nextElementSibling;
          if (panel.style.display === "block") {
            panel.style.display = "none";
          } else {
            panel.style.display = "block";
          }
        });
      }
    </script>  
  
  
  
    <!-- Close the sidebar everytime you resize the screen... -->
    <script>
      $(document).ready(function(){
        
        $(window).resize(closeNav);
        
      });
      
      
      $( window ).resize(function() {

        if($('#mySidebar').width() > 0){

          $('#openButton').children('span').toggleClass('hamburger hamburger--slider" "hamburger hamburger--slider is-active');
          
        }

      });      
    </script>  
  
  
 <!-- 
    <script>
  
      //mapboxgl.accessToken = 'pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4i';
    
      mapboxgl.accessToken = 'pk.eyJ1IjoidHN1Z2ExMSIsImEiOiJjanFmaTA5cGIyaXFoM3hqd3R5dzd3bzU3In0.TFqMjIIYtpcyhzNh4iMcQA';
      var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/dark-v9', // stylesheet location
        center: [-119, 39.7], // starting position [lng, lat]
        zoom: 6 // starting zoom
        });
      
    </script>
-->     


   

  </body>
  
</html> 
